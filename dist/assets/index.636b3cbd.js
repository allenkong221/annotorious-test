var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,r=(t,n,l)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[n]=l,s=(e,t)=>{for(var n in t||(t={}))o.call(t,n)&&r(e,n,t[n]);if(l)for(var n of l(t))a.call(t,n)&&r(e,n,t[n]);return e},i=(e,l)=>t(e,n(l));"undefined"!=typeof require&&require;import{r as c,c as u,a as d,o as p,b as v,d as f,e as m,f as g,g as h,h as b,u as w,F as x,n as y,w as A,v as S,t as k,i as I,j as O,k as j,l as C,m as L,p as M}from"./vendor.83e6b512.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var P=(e,t)=>{for(const[n,l]of t)e[n]=l;return e};var N=P({},[["render",function(e,t){const n=c("router-view");return p(),u("div",null,[d(n)])}]]);const R={default:P({},[["render",function(e,t){const n=c("router-view");return p(),v(n)}]])};const E=["multiple"],q=f({props:{multiple:{type:Boolean,default:!1}},emits:["upload"],setup(e,{emit:t}){const n=e=>{const n=e.target;n.files&&n.files.length&&t("upload",n.files)};return(t,l)=>(p(),u("input",{type:"file",onChange:n,multiple:e.multiple},null,40,E))}}),z={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24"},B=[m("path",{d:"M21 7L9 19l-5.5-5.5l1.41-1.41L9 16.17L19.59 5.59L21 7z",fill:"currentColor"},null,-1)];var H={name:"mdi-check",render:function(e,t){return p(),u("svg",z,B)}};const J=e=>{const t=e.substr(11).split(",");return{left:parseInt(t[0]),top:parseInt(t[1]),width:parseInt(t[2]),height:parseInt(t[3])}},T=g(),U=g(""),D=g([]),F=()=>({initAnnotations(e){T.value=new h.exports.Annotorious({image:e,disableEditor:!0}),T.value.on("createSelection",(async e=>{await T.value.updateSelected(e,!0)})),T.value.on("cancelSelected",(()=>{})),T.value.on("updateAnnotation",((e,t)=>{console.log("updating"),D.value.forEach(((n,l)=>{t.id===n.id&&(D.value[l]=s(s({},D.value[l]),J(e.target.selector.value)))}))})),T.value.on("createAnnotation",(e=>{D.value.push(s({name:"",id:e.id},J(e.target.selector.value))),T.value.selectAnnotation(e.id),U.value=e.id})),T.value.on("selectAnnotation",(e=>{console.log("selected",e.id),U.value=e.id})),T.value.on("deleteAnnotation",(e=>{const t=e.id;U.value="";const n=D.value.findIndex((e=>e.id===t));D.value.splice(n,1)}))},getAnnotations:()=>T.value?(console.log(T.value.getAnnotations()),T.value.getAnnotations().map((e=>s({name:e.body[0].value,id:e.id},J(e.target.selector.value))))):(console.error("Annotations not initialized"),[]),selectAnnotation(e){U.value=e,T.value.selectAnnotation(e)},clearSelection(){U.value="",T.value.cancelSelected()},deleteAnnotation(e){const t=D.value.findIndex((t=>t.id===e));T.value.removeAnnotation(e),U.value="",D.value.splice(t,1),setTimeout((()=>{T.value.cancelSelected()}),50)}}),Y={class:"flex"},$=["value","data-id"],K=f({setup(e){const{selectAnnotation:t,clearSelection:n}=F(),l=async e=>{const n=e.target;console.log(n.dataset.id);const l=D.value.find((e=>e.id===n.dataset.id));l&&(l.name=n.value),t(n.dataset.id||"")};return(e,t)=>{const o=H;return p(!0),u(x,null,b(w(D),(e=>(p(),u("div",{class:"flex absolute bg-blue-400",style:y({top:`calc(${e.top}px - 1.5rem)`,left:`${e.left+e.width}px`})},[A(m("div",Y,[m("input",{type:"text",class:"bg-gray-200 border-1 border-gray-600 h-6 focus:outline-none",value:e.name,onInput:l,"data-id":e.id},null,40,$),m("div",{class:"bg-green-700",onClick:t[0]||(t[0]=(...e)=>w(n)&&w(n)(...e))},[d(o,{class:"text-white"})])],512),[[S,w(U)===e.id]])],4)))),256)}}}),V={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24"},W=[m("path",{d:"M19 4h-3.5l-1-1h-5l-1 1H5v2h14M6 19a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V7H6v12z",fill:"currentColor"},null,-1)];var G={name:"mdi-trash",render:function(e,t){return p(),u("svg",V,W)}};const Q={class:"absolute top-10 right-10 flex flex-col w-60"},X=["onClick"],Z={class:"flex flex-col"},_=f({setup(e){const{selectAnnotation:t,deleteAnnotation:n}=F();return(e,l)=>{const o=G;return p(),u("div",Q,[(p(!0),u(x,null,b(w(D),(e=>(p(),u("div",{class:"flex border-1 border-blue-400 rounded mb-5 p-4 items-center justify-between",onClick:n=>w(t)(e.id)},[m("div",Z,[m("span",null,"Name: "+k(e.name),1),m("span",null,"Left: "+k(e.left),1),m("span",null,"Top: "+k(e.top),1),m("span",null,"Width: "+k(e.width),1),m("span",null,"Height: "+k(e.height),1)]),d(o,{class:"text-blue-600 cursor-pointer",onClick:t=>w(n)(e.id)},null,8,["onClick"])],8,X)))),256))])}}});const ee={class:"flex flex-col justify-center items-center"},te=m("h5",{class:"text-xl text-orange-400"}," Select a file to be used as a template: ",-1),ne={class:"mt-10"},le=m("h5",{class:"text-lg text-orange-400 text-center"}," Click and drag over the image to create a new selection ",-1),oe={class:"relative"},ae=["src"],re=[{name:"index",path:"/",component:f({setup(e){const t=g(),n=g(),l=g(),{initAnnotations:o}=F(),a=e=>{l.value=e[0],t.value=URL.createObjectURL(e[0]),o(n.value)},r=async()=>{const e=new FormData;e.append("file",l.value),e.append("annotations",JSON.stringify(D.value));try{await I.post("http://localhost:5000/test",e,{headers:{"Content-Type":"multipart/form-data;"}})}catch{}finally{alert("sent to the API")}};return(e,l)=>{const o=q,s=K,i=_;return p(),u("div",ee,[te,d(o,{onUpload:a}),A(m("div",ne,[le,m("div",oe,[m("img",{ref:(e,t)=>{t.templateImgRef=e,n.value=e},src:t.value,alt:"template"},null,8,ae),d(s)])],512),[[S,t.value]]),m("button",{onClick:r,class:"text-lg text-red-700 border-1 border-red-700 px-6 py-2 mt-2 absolute top-10 left-10 active:bg-red-100 focus:border-red-700 focus:border-1 focus:outline-none"}," Send to API "),d(i)])}}}),props:!0}].map((e=>{var t;return{path:e.path,component:R[(null==(t=e.meta)?void 0:t.layout)||"default"],children:[i(s({},e),{path:""})]}}));const se=O({history:j(),routes:re});const ie={},ce=C(N);ce.use(se);const ue=L(),de=[];if(localStorage.getItem("piniaState")){const e=JSON.parse(localStorage.getItem("piniaState")||"{}");for(const t of de)e[t]&&(ue.state.value=i(s({},ue.state.value),{[t]:s({},e[t])}))}ce.use(ue),M(ue.state,(e=>{localStorage.setItem("piniaState",JSON.stringify(e))}),{deep:!0});for(const pe in ie)ce.use(ie[pe].default);ce.mount("#app");
