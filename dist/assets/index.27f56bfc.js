import{e as D,g,o as a,p as G,y as w,M as X,R as le,d as e,A as H,T as Z,c as _,w as ue,a as i,t as S,m as s,z as O,F as J,k as ae,S as de,s as _e,C as I,U as ee,h as me,l as pe,B as ne,G as ve,V as fe,j as he}from"./vendor.a3c82905.js";import{o as ce}from"./index.aa4600e3.js";import{_ as P,a as q,b as xe}from"./index.6cc4ddd6.js";import{u as W,d as te,_ as ge,a as ye,b as be,c as $e}from"./BackButton.afb76dee.js";import{a as oe}from"./index.126d1a4e.js";import"./FileUploader.8cc4164a.js";const we={class:"fixed top-0 left-0 w-full h-full bg-gray4 bg-opacity-50 z-5 flex justify-center items-center"},ke=D({props:{modelValue:{type:Boolean,default:!1}},emits:["close","update:modelValue"],setup(v,{emit:n}){const p=v,u=g(null);ce(u,()=>{t()});const t=()=>{p.modelValue&&(n("update:modelValue",!1),n("close"))};return(l,C)=>(a(),G(Z,{name:"grow"},{default:w(()=>[X(e("div",we,[e("div",{ref:(d,y)=>{y.modalContent=d,u.value=d}},[H(l.$slots,"default",{},void 0,!0)],512)],512),[[le,v.modelValue]])]),_:3}))}});var Ce=P(ke,[["__scopeId","data-v-450d55eb"]]);const Ve={width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24"},Ae=e("path",{d:"M15.41 16.58L10.83 12l4.58-4.59L14 6l-6 6l6 6l1.41-1.42z",fill:"currentColor"},null,-1),Me=[Ae];function Te(v,n){return a(),_("svg",Ve,Me)}var Se={name:"mdi-chevron-left",render:Te};const Ne=["value","placeholder","type"],ie=D({props:{modelValue:{type:[String,Number],default:""},placeholder:{type:String,default:""},type:{type:String,default:"text"}},emits:["update:modelValue"],setup(v,{emit:n}){const p=u=>{const t=u.target;n("update:modelValue",t.value)};return(u,t)=>(a(),_("input",{onInput:p,value:v.modelValue,placeholder:v.placeholder,class:"border-1 border-gray-200 p-2 focus:outline-none text-gray-500 placeholder-gray-400",type:v.type},null,40,Ne))}}),Ie={width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 22 22"},je=e("g",{fill:"none"},[e("path",{d:"M4.979 4.636v-.003h.003a36.006 36.006 0 0 1 1.815-.115c1.46-.058 3.193-.05 4.48.142a.386.386 0 0 1 .21.117l7.754 7.753a.5.5 0 0 1 0 .708l-5.657 5.656a.5.5 0 0 1-.707 0l-7.754-7.753a.386.386 0 0 1-.117-.21c-.192-1.287-.2-3.02-.142-4.48c.028-.722.073-1.359.115-1.815z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"}),e("circle",{cx:"9.435",cy:"9.173",r:"1",transform:"rotate(-45 9.435 9.173)",fill:"currentColor"})],-1),Le=[je];function Re(v,n){return a(),_("svg",Ie,Le)}var Fe={name:"pepicons-label",render:Re};const Be={class:"flex w-full"},De={class:"w-4/10 border border-secondary bg-gray1 flex flex-col h-full p-10"},Oe={class:"flex items-center mb-2"},ze={class:"text-small"},Ue=e("h2",{class:"text-h2 font-bold mb-2"},"3. Verify Retrieved Values",-1),Ye=e("p",{class:"text-p mb-4"},' Verify if the value from the document is the same. If the value is not correct, please edit it and then click "Yes" ',-1),Je={key:0,class:"flex flex-col"},Ee={class:"text-h3 font-bold mb-4"},Ge=I(" Is this the correct value for this document's "),He={class:"text-secondary"},Pe=I("? "),qe={class:"flex"},We=I("Not sure"),Ke=I("No"),Qe=I("Yes"),Xe={key:1,class:"flex flex-col"},Ze={class:"flex items-center mb-3"},et=e("h5",{class:"text-h4 font-bold"},"Reasons for the uncertainty:",-1),tt={class:"flex items-center pl-5 mb-1"},ot=["name","onUpdate:modelValue"],st=["for"],lt=I("Submit"),at={class:"w-6/10 h-full overflow-y-auto relative"},nt=["src"],ct=D({emits:["submit"],setup(v,{emit:n}){const{templateImages:p,templateFiles:u}=W(),{processedAnnotations:t}=te(),l=g(0),C=g(""),d=g(0),y=g(),f=g(!1),R=g([{name:"blank",label:"It's blank.",value:!1},{name:"unclear",label:"The handwriting is unclear.",value:!1},{name:"illegible",label:"The text is illegible due to color contrast.",value:!1},{name:"location",label:"The value is placed in a weird location on the page.",value:!1},{name:"context",label:"There's a lack of context to interpret the value.",value:!1},{name:"other",label:"Other reasons.",value:!1}]);ue(l,A=>{C.value=t.value[A].ocrValue,f.value=!1;for(const M of R.value)M.value=!1;const m=new Image;m.src=p.value[t.value[A].fileIndex],m.onload=()=>{var M;d.value=((M=y.value)==null?void 0:M.width)/m.width}},{immediate:!0});const V=async()=>{n("submit"),console.log(t.value);const A=new FormData;A.append("file",u.value[0]),A.append("results",JSON.stringify(t.value));const[m,M]=await ee(oe.post("/api/verification",A));if(m){console.error(m);return}console.log(M)},j=()=>{t.value[l.value].finalValue=C.value,t.value[l.value].resultApproved=!1,l.value+1!==t.value.length?l.value++:V()},F=()=>{t.value[l.value].finalValue=C.value,t.value[l.value].resultApproved=!1,t.value[l.value].failReason=R.value.filter(A=>A.value).map(A=>A.name),l.value+1!==t.value.length?l.value++:V()},Y=()=>{t.value[l.value].finalValue=C.value,t.value[l.value].resultApproved=!0,l.value+1!==t.value.length?l.value++:V()};return(A,m)=>{const M=Fe,z=ie,T=q,E=Se;return a(),_("div",Be,[e("div",De,[e("div",Oe,[i(M,{class:"mr-1 text-small text-secondary"}),e("p",ze,S(l.value+1)+" of "+S(s(t).length)+" Checks ",1)]),Ue,Ye,f.value?O("",!0):(a(),_("div",Je,[e("h5",Ee,[Ge,e("span",He,S(s(t)[l.value].name),1),Pe]),i(z,{class:"mb-6",modelValue:C.value,"onUpdate:modelValue":m[0]||(m[0]=h=>C.value=h)},null,8,["modelValue"]),e("div",qe,[i(T,{type:"secondary",outlined:"",class:"flex-1",onClick:m[1]||(m[1]=h=>f.value=!0)},{default:w(()=>[We]),_:1}),i(T,{type:"secondary",outlined:"",class:"flex-1 mx-2",onClick:j},{default:w(()=>[Ke]),_:1}),i(T,{type:"secondary",class:"flex-1",onClick:Y},{default:w(()=>[Qe]),_:1})])])),f.value?(a(),_("div",Xe,[e("div",Ze,[i(E,{class:"text-p mr-1 cursor-pointer",onClick:m[2]||(m[2]=h=>f.value=!1)}),et]),(a(!0),_(J,null,ae(R.value,h=>(a(),_("div",tt,[X(e("input",{name:h.name,type:"checkbox",class:"mr-2","onUpdate:modelValue":U=>h.value=U},null,8,ot),[[de,h.value]]),e("label",{for:h.name,class:"text-small"},S(h.label),9,st)]))),256)),i(T,{onClick:F,type:"secondary",class:"w-1/2 mt-4 mx-auto"},{default:w(()=>[lt]),_:1})])):O("",!0)]),e("div",at,[e("img",{ref:(h,U)=>{U.imgRef=h,y.value=h},src:s(p)[s(t)[l.value].fileIndex]},null,8,nt),e("div",{class:"absolute border-2 border-primary bg-primary bg-opacity-25",style:_e({top:`${s(t)[l.value].top*d.value}px`,left:`${s(t)[l.value].left*d.value}px`,width:`${s(t)[l.value].width*d.value}px`,height:`${s(t)[l.value].height*d.value}px`})},null,4)])])}}});const it={},rt={class:"simple-card"};function ut(v,n){return a(),_("div",rt,[H(v.$slots,"default",{},void 0,!0)])}var dt=P(it,[["render",ut],["__scopeId","data-v-b693141c"]]);const _t={class:"fixed top-0 left-0 w-full h-full bg-gray4 bg-opacity-50 z-10 flex justify-center items-center"},mt=D({props:{modelValue:{type:Boolean,default:!1}},emits:["close","update:modelValue"],setup(v,{emit:n}){const p=v,u=g(null);ce(u,()=>{t()});const t=()=>{p.modelValue&&(n("update:modelValue",!1),n("close"))};return(l,C)=>(a(),G(Z,{name:"grow"},{default:w(()=>[X(e("div",_t,[e("div",{ref:(d,y)=>{y.modalContent=d,u.value=d},class:"flex w-full justify-center"},[H(l.$slots,"default",{},void 0,!0)],512)],512),[[le,v.modelValue]])]),_:3}))}});var pt=P(mt,[["__scopeId","data-v-3f69ff2b"]]);const vt={width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24"},ft=e("path",{d:"M19 4h-3.5l-1-1h-5l-1 1H5v2h14M6 19a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V7H6v12z",fill:"currentColor"},null,-1),ht=[ft];function xt(v,n){return a(),_("svg",vt,ht)}var gt={name:"mdi-trash",render:xt};const yt={class:"flex flex-col"},bt=["onMouseenter","onMouseleave","onClick"],$t={class:"mr-2"},wt=["id","value","onInput","onFocus","onFocusout"],kt={class:"bg-white w-100 rounded-lg relative flex flex-col p-6"},Ct=e("h5",{class:"text-h3 text-gray4 font-semibold mb-2"}," Are you sure you want to delete this label? ",-1),Vt={class:"text-p text-gray4 mb-2"},At={class:"flex justify-between"},Mt=I("Yes"),Tt=I("No"),St={class:"bg-white w-100 rounded-lg relative flex flex-col p-6"},Nt=e("h5",{class:"text-h3 text-gray4 font-semibold mb-2"}," Are you sure you want to edit this label? ",-1),It={class:"text-p text-gray4 mb-2"},jt={class:"flex justify-between"},Lt=I("Yes"),Rt=I("No"),Ft=D({setup(v){const{templateAnnotations:n,selectedTemplateIndex:p,templateRawAnnotations:u,newTemplateStep:t}=W(),{removeAnnotation:l,selectedAnnotationId:C,selectAnnotation:d,annotations:y}=te(),f=g(""),R=r=>{var o;(o=document.querySelector(`[data-id="${r}"]`))==null||o.classList.add("hovered"),f.value=r},V=r=>{var o;(o=document.querySelector(`[data-id="${r}"]`))==null||o.classList.remove("hovered"),f.value=""},j=g(),F=g(!1),Y=r=>{j.value=n.value[p.value].find(o=>o.id===r),F.value=!0},A=r=>{n.value.forEach((o,L)=>{const x=o.findIndex(N=>N.name===r);L===p.value?l(o[x].id):(o.splice(x,1),u.value[L].splice(x,1))}),F.value=!1},m=g(!1),M=g(0),z=g([]);me(()=>{z.value=[]});const T=g(""),E=r=>{for(let o=0;o<n.value.length;o++)n.value[o].length>0&&(n.value[o][r].name=T.value);y.value[r].name=T.value,M.value=0,m.value=!1,h.value=!1},h=g(!1),U=r=>{h.value=!0,M.value=r,T.value=y.value[r].name},K=(r,o)=>{const L=r.target;T.value=L.value},b=r=>{T.value!==r&&(m.value=!0)},$=()=>{h.value=!1,T.value="",M.value=0,m.value=!1};return(r,o)=>{const L=gt,x=q,N=pt;return a(),_("div",yt,[(a(!0),_(J,null,ae(s(n)[s(p)],(c,B)=>(a(),_("div",{class:pe(["flex p-2 border-2 justify-between cursor-pointer hover:border-secondary transition mb-3 rounded-md",{["border-gray2"]:s(C)!==c.id,["border-secondary"]:s(C)===c.id}]),onMouseenter:k=>R(c.id),onMouseleave:k=>V(c.id),onClick:k=>s(d)(c.id)},[e("p",$t,S(B+1)+".",1),e("input",{ref:k=>{k&&(z.value[B]=k)},id:`label_${B}`,value:h.value?T.value:c.name,onInput:k=>K(k),class:"flex-grow focus:outline-none",onFocus:k=>U(B),onFocusout:k=>b(c.name)},null,40,wt),s(C)===c.id||f.value&&f.value===c.id?(a(),G(L,{key:0,onClick:ne(k=>Y(c.id),["stop"]),class:"text-gray3 transition hover:text-gray4 cursor-pointer"},null,8,["onClick"])):O("",!0)],42,bt))),256)),i(N,{"model-value":F.value,onClose:o[2]||(o[2]=c=>F.value=!1)},{default:w(()=>{var c;return[e("div",kt,[Ct,e("p",Vt,' Deleting this label means deleting "'+S((c=j.value)==null?void 0:c.name)+'" values from every single document for this template. ',1),e("div",At,[i(x,{outlined:"",type:"secondary",class:"w-47/100",onClick:o[0]||(o[0]=B=>{var k;return A((k=j.value)==null?void 0:k.name)})},{default:w(()=>[Mt]),_:1}),i(x,{type:"secondary",class:"w-47/100",onClick:o[1]||(o[1]=B=>F.value=!1)},{default:w(()=>[Tt]),_:1})])])]}),_:1},8,["model-value"]),i(N,{"model-value":m.value,onClose:$},{default:w(()=>{var c;return[e("div",St,[Nt,e("p",It,' Editing this label means changing the labels "'+S((c=s(y)[M.value])==null?void 0:c.name)+'" into "'+S(T.value)+'"" for every single document in this template. ',1),e("div",jt,[i(x,{outlined:"",type:"secondary",class:"w-47/100",onClick:o[3]||(o[3]=B=>E(M.value))},{default:w(()=>[Lt]),_:1}),i(x,{type:"secondary",class:"w-47/100",onClick:$},{default:w(()=>[Rt]),_:1})])])]}),_:1},8,["model-value"])])}}}),Bt=g(!1),Dt=()=>({showLoader:Bt});const Ot={class:"bg-white w-95vw h-90vh rounded-lg relative flex flex-col p-12"},zt={class:"flex mb-5"},Ut={class:"flex h-9/10 justify-between"},Yt={key:0,class:"w-38/100 flex flex-col pl-12"},Jt=e("h5",{class:"text-h2 font-bold mb-4 text-gray4"}," 1. Upload Sample Documents ",-1),Et=e("p",{class:"text-gray4 text-p mb-4"}," As the first step, upload a minimum of 5 documents with the same format. We recommend 10 or more. ",-1),Gt=e("span",{class:"text-small text-secondary"},"Give your template a name",-1),Ht={class:"flex items-center justify-center"},Pt=e("span",null,"Next",-1),qt=e("h5",{class:"text-h2 font-bold mb-4 text-gray4"}," 2. Label the Documents ",-1),Wt={key:0,class:"text-gray4 text-p mb-4"},Kt={key:1,class:"text-gray4 text-p mb-4"},Qt={class:"mt-auto flex flex-col"},Xt=e("p",{class:"text-p text-gray4 mb-2"}," Once you have finished labeling this document, click Next. ",-1),Zt=e("h5",{class:"text-h2 font-bold mb-4 text-gray4"}," 3. Verify Retrieved Values ",-1),eo=e("p",{class:"text-gray4 text-p mb-2"}," For each label, please verify if the values are correct. This will improve the accuracy of the model and save you more time in the future. ",-1),to={class:"text-gray4 text-p mb-4"},oo=e("div",{class:"flex items-center"},[e("h2",{class:"text-h2 font-bold mr-2"},"Processing"),e("div",{class:"lds-dual-ring"})],-1),so=[oo],lo=D({setup(v){const n=g(6),p=g(10),{showLoader:u}=Dt(),{showNewTemplateModal:t,steps:l,newTemplateImage:C,newTemplateStep:d,templateImages:y,templateAnnotations:f,templateRawAnnotations:R,selectedTemplateIndex:V,newTemplateName:j,firstTemplateReady:F,templateFiles:Y}=W(),{getRawAnnotations:A,annotations:m,toggleAnnotations:M,processedAnnotations:z}=te(),T=ve(),E=()=>{if(y.value.length<5){T.warning("Please upload at least 5 samples before proceeding");return}else if(j.value===""){T.warning("Please set a name for your template");return}d.value=1;const b=y.value.length;f.value=[],R.value=[];for(let $=0;$<b;$++)f.value.push([]),R.value.push([])},h=async()=>{if(V.value===0&&!F.value){F.value=!0;for(let b=0;b<f.value.length;b++)f.value[b]=JSON.parse(JSON.stringify(m.value)),R.value[b]=A()}if(V.value===y.value.length-1){await U(),d.value=2;return}K(V.value+1)},U=async()=>{const b=new FormData;for(const x of Y.value)b.append("files",x);b.append("annotations",JSON.stringify(f.value)),b.append("name",j.value),console.log(b),u.value=!0;const[$,r]=await ee(oe.post("/api/create_template_multidata",b));if(u.value=!1,$){console.error($);return}console.log(r);const o=[];Y.value.forEach((x,N)=>{f.value[N].forEach((c,B)=>{const k=r.data.message[N],Q={fileIndex:N,name:c.name,id:c.id,top:c.top,left:c.left,width:c.width,height:c.height,ocrValue:k[c.name]};o.push(Q)})});const L=[...new Set(o.map(x=>x.id))];for(let x=0;x<L.length;x++)z.value=[...z.value,...o.filter(N=>N.id===L[x])];M(),V.value=0},K=b=>{const $=V.value,r=A();R.value[$]=r,f.value[$]=JSON.parse(JSON.stringify(m.value)),V.value=b,m.value=JSON.parse(JSON.stringify(f.value[b]))};return(b,$)=>{const r=ge,o=ye,L=be,x=ie,N=$e,c=q,B=Ft,k=dt,Q=ct,re=Ce;return a(),G(re,{"model-value":s(t),onClose:$[2]||($[2]=se=>t.value=!1)},{default:w(()=>[e("div",Ot,[e("div",zt,[i(r,{class:"mr-16"}),i(o,{steps:s(l),"active-index":s(d)},null,8,["steps","active-index"])]),e("div",Ut,[s(d)<2?(a(),_(J,{key:0},[i(L,{class:"w-62/100"}),s(C)?O("",!0):(a(),_("div",Yt,[s(d)===0?(a(),_(J,{key:0},[Jt,Et,Gt,i(x,{modelValue:s(j),"onUpdate:modelValue":$[0]||($[0]=se=>fe(j)?j.value=se:null),class:"mb-6 border-gray3",placeholder:"Template Name"},null,8,["modelValue"]),i(c,{type:"primary",onClick:E},{default:w(()=>[e("div",Ht,[Pt,i(N)])]),_:1})],64)):s(d)===1?(a(),_(J,{key:1},[qt,s(V)===0?(a(),_("p",Wt," Create a bounding box around each text area you want to capture and give it a label. Once you've finished labeling, click 'Next'. ")):s(V)!==0?(a(),_("p",Kt,S(s(V)===s(y).length-1?"Congrats! Now we're off to the verification step!":`Great job! You've labelled your first document. For the remaining
              documents, adjust each bounding box to ensure the texts are
              covered.`),1)):O("",!0),i(B),e("div",Qt,[Xt,i(c,{outlined:"",onClick:h},{default:w(()=>[I(S(s(V)===s(y).length-1?"Submit":"Next"),1)]),_:1})])],64)):s(d)===2?(a(),_(J,{key:2},[Zt,eo,e("p",to," There are "+S(n.value)+" labels x "+S(p.value)+" documents = "+S(n.value*p.value)+" values to check in total. ",1),i(k)],64)):O("",!0)]))],64)):s(d)===2?(a(),G(Q,{key:1})):O("",!0)]),i(Z,{name:"loader"},{default:w(()=>[s(u)?(a(),_("div",{key:0,class:"z-100 bg-white w-full h-full flex justify-center items-center absolute top-0 left-0",onClick:$[1]||($[1]=ne(()=>{},["stop"]))},so)):O("",!0)]),_:1})])]),_:1},8,["model-value"])}}});const ao=D({emits:["click"],setup(v,{emit:n}){return(p,u)=>(a(),_("div",{onClick:u[0]||(u[0]=t=>n("click")),class:"template-card border-dashed border-2 border-secondary rounded-lg h-100 w-100 flex justify-center items-center cursor-pointer bg-gray1 hover:bg-gray2 hover:bg-opacity-25 transition"},[H(p.$slots,"default",{},void 0,!0)]))}});var no=P(ao,[["__scopeId","data-v-66053c66"]]);const co={width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 15 15"},io=e("g",{fill:"none"},[e("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M3.292.049a.5.5 0 0 1 .535.077L12.86 7.95a.5.5 0 0 1-.306.878l-3.334.147l1.931 4.244a.5.5 0 0 1-.247.662l-2.153.98a.5.5 0 0 1-.662-.247L6.153 10.37l-2.29 2.416A.5.5 0 0 1 3 12.44V.504a.5.5 0 0 1 .292-.455zM4 1.599v9.589l1.938-2.044a.5.5 0 0 1 .818.137l2.035 4.463l1.242-.566l-2.031-4.463a.5.5 0 0 1 .433-.707l2.82-.124L4 1.599z",fill:"currentColor"})],-1),ro=[io];function uo(v,n){return a(),_("svg",co,ro)}var _o={name:"radix-icons-cursor-arrow",render:uo};const mo={cass:"flex flex-col"},po={class:"flex items-center justify-between"},vo={class:"flex items-center mb-8"},fo=e("h1",{class:"text-h1 font-extrabold"},"Templates",-1),ho=I("Upload File"),xo=e("p",{class:"text-p"}," Create a new template or use an existing template to extract data from your documents. ",-1),go={class:"flex mt-8"},yo={class:"flex flex-col justify-center items-center w-full h-full group hover:bg-secondary transition"},bo={class:"flex items-center mb-2"},$o=e("span",{class:"text-p text-gray3 uppercase group-hover:text-white transition"},"Click Here",-1),wo=e("span",{class:"text-h3 font-semibold text-center"},[e("span",{class:"text-error group-hover:text-white transition"},"Create "),e("span",{class:"text-black group-hover:text-white transition"},"a "),e("span",{class:"text-primary group-hover:text-white transition"},"new "),e("span",{class:"text-secondary group-hover:text-white transition"},"template")],-1),So=D({setup(v){const{showNewTemplateModal:n}=W();return he(async()=>{const[p,u]=await ee(oe.post("/api/get_filenames"));if(p){console.error(p);return}console.log(u.data)}),(p,u)=>{const t=xe,l=q,C=_o,d=no,y=lo;return a(),_("div",mo,[e("div",po,[e("div",vo,[i(t,{class:"text-h1 text-secondary mr-2"}),fo]),i(l,{type:"secondary",disabled:"",class:"my-auto"},{default:w(()=>[ho]),_:1})]),xo,e("div",go,[i(d,{onClick:u[0]||(u[0]=f=>n.value=!0)},{default:w(()=>[e("div",yo,[e("div",bo,[i(C,{class:"text-secondary text-p mr-1 group-hover:text-white transition"}),$o]),wo])]),_:1})]),i(y)])}}});export{So as default};
