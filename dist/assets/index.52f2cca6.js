import{O as R,P as X,g as v,i as O,Q as Y,w as E,m as U}from"./vendor.3ec79051.js";function b(t){return R()?(X(t),!0):!1}const _=typeof window!="undefined",C=t=>typeof t=="string",S=()=>{};function H(t){let n;function i(){return n||(n=t()),n}return i.reset=async()=>{const s=n;n=void 0,s&&await s},i}function M(t){var n;const i=U(t);return(n=i==null?void 0:i.$el)!=null?n:i}const D=_?window:void 0;_&&window.document;const N=_?window.navigator:void 0;function d(...t){let n,i,s,e;if(C(t[0])?([i,s,e]=t,n=D):[n,i,s,e]=t,!n)return S;let u=S;const r=E(()=>U(n),a=>{u(),!!a&&(a.addEventListener(i,s,e),u=()=>{a.removeEventListener(i,s,e),u=S})},{immediate:!0,flush:"post"}),o=()=>{r(),u()};return b(o),o}function G(t,n,i={}){const{window:s=D,event:e="pointerdown"}=i;return s?d(s,e,r=>{const o=M(t);!o||o===r.target||r.composedPath().includes(o)||n(r)},{passive:!0}):void 0}function W(t,n={}){const{controls:i=!1,navigator:s=N}=n,e=Boolean(s&&"permissions"in s);let u;const r=typeof t=="string"?{name:t}:t,o=v(),a=()=>{u&&(o.value=u.state)},c=H(async()=>{if(!!e){if(!u)try{u=await s.permissions.query(r),d(u,"change",a),a()}catch{o.value="prompt"}return u}});return c(),i?{state:o,isSupported:e,query:c}:o}function F(t={}){const{navigator:n=N,requestPermissions:i=!1,onUpdated:s}=t,e=v([]),u=O(()=>e.value.filter(p=>p.kind==="videoinput")),r=O(()=>e.value.filter(p=>p.kind==="audioinput")),o=O(()=>e.value.filter(p=>p.kind==="audiooutput"));let a=!1;const c=v(!1);async function l(){!a||(e.value=await n.mediaDevices.enumerateDevices(),s==null||s(e.value))}async function f(){if(!a)return!1;if(c.value)return!0;const{state:p,query:g}=W("camera",{controls:!0});return await g(),p.value!=="granted"&&((await n.mediaDevices.getUserMedia({audio:!0,video:!0})).getTracks().forEach(h=>h.stop()),l()),c.value=!0,c.value}return n&&(a=Boolean(n.mediaDevices&&n.mediaDevices.enumerateDevices),a&&(i&&f(),d(n.mediaDevices,"devicechange",l),l())),{devices:e,ensurePermissions:f,permissionGranted:c,videoInputs:u,audioInputs:r,audioOutputs:o,isSupported:a}}function q(t={}){const{touch:n=!0,resetOnTouchEnds:i=!1,initialValue:s={x:0,y:0},window:e=D}=t,u=v(s.x),r=v(s.y),o=v(null),a=f=>{u.value=f.pageX,r.value=f.pageY,o.value="mouse"},c=()=>{u.value=s.x,r.value=s.y},l=f=>{f.touches.length>0&&(u.value=f.touches[0].clientX,r.value=f.touches[0].clientY,o.value="touch")};return e&&(d(e,"mousemove",a,{passive:!0}),d(e,"dragover",a,{passive:!0}),n&&(d(e,"touchstart",l,{passive:!0}),d(e,"touchmove",l,{passive:!0}),i&&d(e,"touchend",c,{passive:!0}))),{x:u,y:r,sourceType:o}}function V(t,n={}){const{handleOutside:i=!0,window:s=D}=n,{x:e,y:u,sourceType:r}=q(n),o=v(t!=null?t:s==null?void 0:s.document.body),a=v(0),c=v(0),l=v(0),f=v(0),p=v(0),g=v(0),w=v(!1);let h=()=>{};return s&&(h=E([o,e,u],()=>{const y=M(o);if(!y)return;const{left:m,top:P,width:x,height:L}=y.getBoundingClientRect();l.value=m+s.pageXOffset,f.value=P+s.pageYOffset,p.value=L,g.value=x;const I=e.value-l.value,T=u.value-f.value;w.value=I<0||T<0||I>g.value||T>p.value,(i||!w.value)&&(a.value=I,c.value=T)},{immediate:!0})),{x:e,y:u,sourceType:r,elementX:a,elementY:c,elementPositionX:l,elementPositionY:f,elementHeight:p,elementWidth:g,isOutside:w,stop:h}}function j(t={}){const{touch:n=!0,drag:i=!0,initialValue:s=!1,window:e=D}=t,u=v(s),r=v(null);if(!e)return{pressed:u,sourceType:r};const o=l=>()=>{u.value=!0,r.value=l},a=()=>{u.value=!1,r.value=null},c=O(()=>M(t.target)||e);return d(c,"mousedown",o("mouse"),{passive:!0}),d(e,"mouseleave",a,{passive:!0}),d(e,"mouseup",a,{passive:!0}),i&&(d(c,"dragstart",o("mouse"),{passive:!0}),d(e,"drop",a,{passive:!0}),d(e,"dragend",a,{passive:!0})),n&&(d(c,"touchstart",o("touch"),{passive:!0}),d(e,"touchend",a,{passive:!0}),d(e,"touchcancel",a,{passive:!0})),{pressed:u,sourceType:r}}var k;(function(t){t.UP="UP",t.RIGHT="RIGHT",t.DOWN="DOWN",t.LEFT="LEFT",t.NONE="NONE"})(k||(k={}));function Q(t={}){var n,i,s;const e=v((n=t.enabled)!=null?n:!1),u=v((i=t.autoSwitch)!=null?i:!0),r=v(t.videoDeviceId),o=v(t.audioDeviceId),{navigator:a=N}=t,c=Boolean((s=a==null?void 0:a.mediaDevices)==null?void 0:s.getUserMedia),l=Y();function f(m){return m.value==="none"||m.value===!1?!1:m.value==null?!0:{deviceId:m.value}}async function p(){if(!(!c||l.value))return l.value=await a.mediaDevices.getUserMedia({video:f(r),audio:f(o)}),l.value}async function g(){var m;(m=l.value)==null||m.getTracks().forEach(P=>P.stop()),l.value=void 0}function w(){g(),e.value=!1}async function h(){return await p(),l.value&&(e.value=!0),l.value}async function y(){return g(),await h()}return E(e,m=>{m?p():g()},{immediate:!0}),E([r,o],()=>{u.value&&l.value&&y()},{immediate:!0}),{isSupported:c,stream:l,start:h,stop:w,restart:y,videoDeviceId:r,audioDeviceId:o,enabled:e,autoSwitch:u}}export{Q as a,j as b,V as c,G as o,F as u};
